<!DOCTYPE html>
<html lang="en" class="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Raxx Predictor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .number-block {
      width: 2.5rem;
      height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.25rem;
      font-weight: bold;
    }
    .number-red { background-color: #f87171; color: white; }
    .number-blue { background-color: #60a5fa; color: white; }
    .number-green { background-color: #4ade80; color: white; }
    .number-small { font-size: 0.875rem; }
    .number-medium { font-size: 1rem; }
    .number-large { font-size: 1.125rem; }
    .dark .number-red { background-color: #dc2626; }
    .dark .number-blue { background-color: #2563eb; }
    .dark .number-green { background-color: #16a34a; }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-800 transition-colors duration-300 min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-3xl">
    <header class="flex justify-between items-center mb-8">
      <h1 class="text-3xl font-bold text-gray-800 dark:text-white">
        ðŸ”® Raxx Predictor
      </h1>
      <button id="theme-toggle" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
      </button>
    </header>

    <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-6 mb-6">
      <div class="mb-4">
        <label for="numbers-input" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Enter last 5 numbers (0-9), comma-separated:
        </label>
        <input 
          type="text" 
          id="numbers-input" 
          placeholder="e.g., 1,3,5,2,4" 
          class="w-full px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
          pattern="^([0-9]+,){4}[0-9]+$"
          title="Enter 5 numbers between 0-9 separated by commas"
          required
        >
      </div>
      <button 
        id="predict-btn" 
        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-200"
      >
        Predict Next Number
      </button>
    </div>

    <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Prediction Results</h2>
      
      <div id="prediction-result" class="space-y-4">
        <div class="flex flex-col sm:flex-row gap-4 mb-4">
          <div class="flex-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
            <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Predicted Color:</h3>
            <div id="predicted-color" class="text-lg font-bold"></div>
          </div>
          <div class="flex-1 bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
            <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Predicted Size:</h3>
            <div id="predicted-size" class="text-lg font-bold"></div>
          </div>
        </div>

        <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
          <h3 class="font-medium text-gray-700 dark:text-gray-300 mb-2">Suggested Number(s):</h3>
          <div id="suggested-numbers" class="flex flex-wrap gap-2"></div>
        </div>
      </div>
    </div>

    <div class="bg-white dark:bg-gray-700 rounded-lg shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">Last 5 Numbers</h2>
      <div id="last-numbers" class="flex gap-2 mb-4"></div>
      
      <div class="mb-2 flex justify-between items-center">
        <h3 class="font-medium text-gray-700 dark:text-gray-300">Prediction History</h3>
        <button id="clear-history" class="text-sm text-red-600 dark:text-red-400 hover:underline">Clear History</button>
      </div>
      <div id="history-list" class="space-y-2"></div>
    </div>
  </div>

  <script>
    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });

    // Initialize theme
    if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }

    // Number properties: color and size categories
    const numberProperties = {
      0: { color: 'red', size: 'small' },
      1: { color: 'red', size: 'medium' },
      2: { color: 'red', size: 'large' },
      3: { color: 'blue', size: 'small' },
      4: { color: 'blue', size: 'medium' },
      5: { color: 'blue', size: 'large' },
      6: { color: 'green', size: 'small' },
      7: { color: 'green', size: 'medium' },
      8: { color: 'green', size: 'large' },
      9: { color: 'red', size: 'small' } // Note: 9 repeats 0's properties
    };

    // Color prediction logic
    function predictColor(numbers) {
      const colors = numbers.map(n => numberProperties[n].color);
      
      // Check for 3+ same color in a row
      for (let i = 0; i <= colors.length - 3; i++) {
        if (colors[i] === colors[i+1] && colors[i] === colors[i+2]) {
          return getOppositeColor(colors[i]);
        }
      }
      
      // Check for alternating pattern
      let isAlternating = true;
      for (let i = 0; i < colors.length - 1; i++) {
        if (colors[i] === colors[i+1]) {
          isAlternating = false;
          break;
        }
      }
      if (isAlternating) {
        return colors[colors.length - 1];
      }
      
      // Else pick rarest in last 5
      return findRarest(colors);
    }

    // Size prediction logic (same as color prediction)
    function predictSize(numbers) {
      const sizes = numbers.map(n => numberProperties[n].size);
      
      // Check for 3+ same size in a row
      for (let i = 0; i <= sizes.length - 3; i++) {
        if (sizes[i] === sizes[i+1] && sizes[i] === sizes[i+2]) {
          return getOppositeSize(sizes[i]);
        }
      }
      
      // Check for alternating pattern
      let isAlternating = true;
      for (let i = 0; i < sizes.length - 1; i++) {
        if (sizes[i] === sizes[i+1]) {
          isAlternating = false;
          break;
        }
      }
      if (isAlternating) {
        return sizes[sizes.length - 1];
      }
      
      // Else pick rarest in last 5
      return findRarest(sizes);
    }

    // Helper functions
    function getOppositeColor(color) {
      const colorMap = {
        red: ['blue', 'green'],
        blue: ['red', 'green'],
        green: ['red', 'blue']
      };
      return colorMap[color][Math.floor(Math.random() * colorMap[color].length)];
    }

    function getOppositeSize(size) {
      const sizeMap = {
        small: ['medium', 'large'],
        medium: ['small', 'large'],
        large: ['small', 'medium']
      };
      return sizeMap[size][Math.floor(Math.random() * sizeMap[size].length)];
    }

    function findRarest(items) {
      const counts = {};
      items.forEach(item => {
        counts[item] = (counts[item] || 0) + 1;
      });
      const sorted = Object.entries(counts).sort((a, b) => a[1] - b[1]);
      return sorted[0][0];
    }

    // Get numbers matching predicted color and size
    function getSuggestedNumbers(predictedColor, predictedSize) {
      return Object.entries(numberProperties)
        .filter(([_, props]) => props.color === predictedColor && props.size === predictedSize)
        .map(([num]) => num);
    }

    // Update UI functions
    function updateLastNumbersDisplay(numbers) {
      const container = document.getElementById('last-numbers');
      container.innerHTML = '';
      
      numbers.forEach(num => {
        const props = numberProperties[num];
        const block = document.createElement('div');
        block.className = `number-block number-${props.color} number-${props.size}`;
        block.textContent = num;
        container.appendChild(block);
      });
    }

    function updatePredictionResults(predictedColor, predictedSize, suggestedNumbers) {
      document.getElementById('predicted-color').textContent = predictedColor;
      document.getElementById('predicted-color').className = `text-${predictedColor === 'red' ? 'red' : predictedColor === 'blue' ? 'blue' : 'green'}-600 dark:text-${predictedColor === 'red' ? 'red' : predictedColor === 'blue' ? 'blue' : 'green'}-400`;
      
      document.getElementById('predicted-size').textContent = predictedSize;
      document.getElementById('predicted-size').className = predictedSize === 'small' ? 'text-sm' : predictedSize === 'medium' ? 'text-base' : 'text-lg';
      
      const suggestedNumbersContainer = document.getElementById('suggested-numbers');
      suggestedNumbersContainer.innerHTML = '';
      
      suggestedNumbers.forEach(num => {
        const props = numberProperties[num];
        const block = document.createElement('div');
        block.className = `number-block number-${props.color} number-${props.size}`;
        block.textContent = num;
        suggestedNumbersContainer.appendChild(block);
      });
    }

    function addToHistory(numbers, predictedColor, predictedSize, suggestedNumbers) {
      const historyList = document.getElementById('history-list');
      const historyItem = document.createElement('div');
      historyItem.className = 'bg-gray-100 dark:bg-gray-800 rounded-lg p-3';
      
      const time = new Date().toLocaleTimeString();
      
      let numbersDisplay = '';
      numbers.forEach(num => {
        const props = numberProperties[num];
        numbersDisplay += `<span class="number-block number-${props.color} number-${props.size}">${num}</span>`;
      });
      
      let suggestedDisplay = '';
      suggestedNumbers.forEach(num => {
        const props = numberProperties[num];
        suggestedDisplay += `<span class="number-block number-${props.color} number-${props.size}">${num}</span>`;
      });
      
      historyItem.innerHTML = `
        <div class="flex justify-between items-start mb-1">
          <div class="text-sm font-medium text-gray-700 dark:text-gray-300">${time}</div>
          <div class="flex gap-1">${numbersDisplay}</div>
        </div>
        <div class="flex flex-col sm:flex-row gap-2 text-sm">
          <div>Predicted: <span class="font-medium">${predictedColor}, ${predictedSize}</span></div>
          <div>Suggested: ${suggestedDisplay}</div>
        </div>
      `;
      
      historyList.insertBefore(historyItem, historyList.firstChild);
      
      // Save to localStorage
      const history = JSON.parse(localStorage.getItem('raxxPredictorHistory') || '[]');
      history.unshift({
        numbers,
        predictedColor,
        predictedSize,
        suggestedNumbers,
        timestamp: new Date().toISOString()
      });
      localStorage.setItem('raxxPredictorHistory', JSON.stringify(history.slice(0, 20))); // Keep last 20 entries
    }

    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('raxxPredictorHistory') || '[]');
      const historyList = document.getElementById('history-list');
      historyList.innerHTML = '';
      
      history.forEach(entry => {
        const historyItem = document.createElement('div');
        historyItem.className = 'bg-gray-100 dark:bg-gray-800 rounded-lg p-3';
        
        const time = new Date(entry.timestamp).toLocaleTimeString();
        
        let numbersDisplay = '';
        entry.numbers.forEach(num => {
          const props = numberProperties[num];
          numbersDisplay += `<span class="number-block number-${props.color} number-${props.size}">${num}</span>`;
        });
        
        let suggestedDisplay = '';
        entry.suggestedNumbers.forEach(num => {
          const props = numberProperties[num];
          suggestedDisplay += `<span class="number-block number-${props.color} number-${props.size}">${num}</span>`;
        });
        
        historyItem.innerHTML = `
          <div class="flex justify-between items-start mb-1">
            <div class="text-sm font-medium text-gray-700 dark:text-gray-300">${time}</div>
            <div class="flex gap-1">${numbersDisplay}</div>
          </div>
          <div class="flex flex-col sm:flex-row gap-2 text-sm">
            <div>Predicted: <span class="font-medium">${entry.predictedColor}, ${entry.predictedSize}</span></div>
            <div>Suggested: ${suggestedDisplay}</div>
          </div>
        `;
        
        historyList.appendChild(historyItem);
      });
    }

    // Event listeners
    document.getElementById('predict-btn').addEventListener('click', () => {
      const input = document.getElementById('numbers-input').value.trim();
      if (!input) return;
      
      const numbers = input.split(',').map(num => parseInt(num.trim()));
      
      // Validate input
      if (numbers.length !== 5 || numbers.some(num => isNaN(num) || num < 0 || num > 9)) {
        alert('Please enter exactly 5 numbers between 0-9, comma-separated.');
        return;
      }
      
      const predictedColor = predictColor(numbers);
      const predictedSize = predictSize(numbers);
      const suggestedNumbers = getSuggestedNumbers(predictedColor, predictedSize);
      
      updateLastNumbersDisplay(numbers);
      updatePredictionResults(predictedColor, predictedSize, suggestedNumbers);
      addToHistory(numbers, predictedColor, predictedSize, suggestedNumbers);
    });

    document.getElementById('clear-history').addEventListener('click', () => {
      localStorage.removeItem('raxxPredictorHistory');
      document.getElementById('history-list').innerHTML = '';
    });

    // Load history on page load
    document.addEventListener('DOMContentLoaded', loadHistory);
  </script>
</body>
</html>
